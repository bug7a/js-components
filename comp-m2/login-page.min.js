"use strict";const LoginPageDefaults={supabase:null,panelWidth:420,primaryColor:"#2C5A38",tab_backgroundColorBottom:"#242424",tab_backgroundColorTop:"#242424",tab_borderColor:White(.1),tab_border:1,tab_textColor:White(.75),tab_selectedColor:"#000000",input_backgroundColor:"#141414",input_lineColor:"transparent",input_selectedBackgroundColor:"#202020",input_textColor:White(.85),input_border:1,input_borderColor:White(.1),panelName:"MY PANEL v25.08.11",googleLogo:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg",appleLogo:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSRsP-EH-Fc-gjQMFgxj4g1pkFGVCK8Y2deHA&s",onSuccess:function(){}},LoginPage=function(t={}){mergeIntoIfMissing(t,LoginPageDefaults),t.left=0,t.top=0,t.width="100%",t.height="100%";let o=startObject(t);o.setActiveTab=function(t){0===t?(o.viewGroup.left=0,o.loginBox.opacity=1,o.signupBox.opacity=0):(o.viewGroup.left=-1*o.panelWidth,o.loginBox.opacity=0,o.signupBox.opacity=1)},o.createButtonWithIcon=function(t,o,e){HGroup({width:"100%",height:50,round:4,color:"#141414",gap:12,border:1,borderColor:White(.1)}),that.elem.style.cursor="pointer",that.on("click",e),UIEffects.button(that),Icon(0,0,24,24),that.load(o),Label({text:t,textColor:White(.75),fontSize:20}),endBox()};const e=function(t){t.background.round=4,t.background.border=o.input_border,t.background.borderColor=o.input_borderColor,t.warningBall.borderColor=Black(1),"textarea"===t.type||(t.input.textColor=o.input_textColor)},a=function(){const t=o.loginEmail.getInputValue().length,e=o.loginPassword.getInputValue().length;t>0&&e>0&&0===o.loginEmail.status?(o.loginBtn.clickable=1,o.loginBtn.elem.style.filter="grayscale(0%)"):(o.loginBtn.clickable=0,o.loginBtn.elem.style.filter="grayscale(100%)")},n=function(){const t=o.signupEmail.status,e=o.signupPassword.status,a=o.signupPassword2.status;0===t&&0===e&&0===a?(o.signupBtn.clickable=1,o.signupBtn.elem.style.filter="grayscale(0%)"):(o.signupBtn.clickable=0,o.signupBtn.elem.style.filter="grayscale(100%)")},i=async function(){const{data:t,error:e}=await o.supabase.auth.signInWithOAuth({provider:"google",options:{redirectTo:"http://example.com/auth/callback"}})},r=async function(){const{data:t,error:e}=await o.supabase.auth.signInWithOAuth({provider:"apple",options:{redirectTo:"http://example.com/auth/callback"}})},l=async function(){const t=o.loginEmail.getInputValue(),e=o.loginPassword.getInputValue();if(t&&e){o.waiting.show();try{const{data:a,error:n}=await o.supabase.auth.signInWithPassword({email:t,password:e});n?o.showAlert("Login failed: "+n.message):o.onSuccess()}catch(t){o.showAlert("Login error")}finally{o.waiting.hide()}}else o.showAlert("Please enter email and password")},s=async function(){const t=o.signupEmail.getInputValue(),e=o.signupPassword.getInputValue(),a=o.signupPassword2.getInputValue();if(t&&e&&a)if(e===a){o.waiting.show();try{const{error:a}=await o.supabase.auth.signUp({email:t,password:e});a?o.showAlert("Sign up failed: "+a.message):(o.showAlert("Sign up successful. Check your email to confirm.","#5DB182"),o.signupPassword.setInputValue(""),o.signupPassword2.setInputValue(""),o.loginEmail.setInputValue(o.signupEmail.getInputValue()),o.setActiveTab(0))}catch(t){o.showAlert("Sign up error")}finally{o.waiting.hide()}}else o.showAlert("Passwords do not match");else o.showAlert("Please fill all fields")};return function(){o.container=AutoLayout({flow:"vertical",align:"center top",width:"100%",height:"100%",padding:[30,50],gap:40}),o.title=Label({text:o.panelName,right:30,bottom:30,fontSize:20,textColor:White(.4),position:"absolute"}),o.tabBar=TextTabs({key:"0",selectedIndex:0,tabList:["LOGIN","SIGN UP"],invertColor:0,backgroundStyle:{colorBottom:o.tab_backgroundColorBottom,colorTop:o.tab_backgroundColorTop,round:8,border:o.tab_border,borderColor:o.tab_borderColor},labelStyle:{fontSize:14,textColor:o.tab_textColor,padding:[12,4],round:0,color:"transparent"},selectedStyle:{color:o.tab_selectedColor,round:6,border:0,borderColor:Black(.2)}}),that.onClick=function(t){o.setActiveTab(t.index)},o.contentContainer=startBox({width:o.panelWidth,height:"auto",color:"transparent",clipContent:0}),o.viewGroup=HGroup({align:"left top",height:"auto",color:"transparent",width:2*o.panelWidth}),o.viewGroup.setMotion("left 0.2s"),o.loginBox=AutoLayout({flow:"vertical",align:"left top",gap:10,height:"auto",width:o.panelWidth,color:"transparent",opacity:0}),that.setMotion("opacity 0.2s");const t={width:"100%",leftPadding:16,rightPadding:16,backgroundColor:o.input_backgroundColor,lineColor:o.input_lineColor,selectedBackgroundColor:o.input_selectedBackgroundColor,selectedLineColor:o.primaryColor};o.loginEmail=EmailInputB({...t,titleText:"EMAIL",placeholder:"example@site.com",isRequired:0,maxChar:60,inputValue:""}),e(that),that.onEdit=function(){a()},o.loginPassword=PasswordInputB({...t,titleText:"PASSWORD",placeholder:"Enter your password",maxChar:60,showShowPasswordButton:1,isRequired:0,showPasswordIconFile:"../../comp-m2/password-input-b/show-btn.png",hidePasswordIconFile:"../../comp-m2/password-input-b/hide-btn.png",inputValue:"",minChar:0,mustUseNumber:0,mustUseLetter:0,mustUseUppercase:0,mustUseLowercase:0,mustUseSpecialChar:0}),e(that),that.btnShowPassword.elem.style.filter="invert(100%)",that.onEdit=function(){a()},o.loginBtn=Button({text:"LOGIN",textColor:White(.75),fontSize:20,width:"100%",height:50,round:4,color:o.primaryColor,minimal:1}),o.loginBtn.clickable=1,o.loginBtn.elem.style.cursor="pointer",UIEffects.button(that),startBox({width:"100%",height:60,color:"transparent"}),Box(0,0,"100%",1,{color:White(.1)}),that.center("top"),that.top+=2,Label({text:"or",textColor:White(.75),color:"#000000",padding:[12,6]}),that.center(),endBox(),o.createButtonWithIcon("Sign in with Google",o.googleLogo,i),o.createButtonWithIcon("Sign in with Apple",o.appleLogo,r),endAutoLayout(),o.signupBox=AutoLayout({flow:"vertical",align:"left top",gap:10,height:"auto",width:o.panelWidth,color:"transparent"}),that.opacity=0,that.setMotion("opacity 0.2s"),o.signupEmail=EmailInputB({...t,titleText:"EMAIL",placeholder:"example@site.com",isRequired:1,maxChar:60}),e(that),that.onEdit=function(){n()},o.signupPassword=PasswordInputB({...t,titleText:"PASSWORD",placeholder:"Create a password",maxChar:60,showShowPasswordButton:1,showPasswordIconFile:"../../comp-m2/password-input-b/show-btn.png",hidePasswordIconFile:"../../comp-m2/password-input-b/hide-btn.png",minChar:8,minCharWarningText:"Password must be at least 8 characters",mustUseNumber:1,mustUseLetter:1,mustUseUppercase:0,mustUseLowercase:0,mustUseSpecialChar:0}),e(that),that.btnShowPassword.elem.style.filter="invert(100%)",that.onEdit=function(){n()},o.signupPassword2=PasswordInputB({...t,titleText:"CONFIRM PASSWORD",placeholder:"Re-enter password",maxChar:60,showShowPasswordButton:1,showPasswordIconFile:"../../comp-m2/password-input-b/show-btn.png",hidePasswordIconFile:"../../comp-m2/password-input-b/hide-btn.png",minChar:8,minCharWarningText:"Password must be at least 8 characters",mustUseNumber:1,mustUseLetter:1,mustUseUppercase:0,mustUseLowercase:0,mustUseSpecialChar:0}),e(that),that.btnShowPassword.elem.style.filter="invert(100%)",that.onEdit=function(){n()},o.signupBtn=Button({text:"SIGN UP",textColor:White(.75),fontSize:20,width:"100%",height:50,round:4,color:o.primaryColor,minimal:1}),UIEffects.button(that),o.signupBtn.clickable=1,o.signupBtn.elem.style.cursor="pointer",endAutoLayout(),endGroup(),endBox(),endAutoLayout(),o.alertBox=startBox(0,0,"100%","100%",{color:Black(.8),opacity:0,clickable:0}),o.alertBox.setMotion("opacity 0.2s"),o.lblAlert=Label({left:40,top:40,text:"",textColor:"indianred",padding:[12,4],round:4,border:1,borderColor:White(.2)}),endBox(),o.showAlert=function(t="Error",e="indianred"){o.lblAlert.text=t,o.lblAlert.textColor=e,o.alertBox.opacity=1,o.alertBox.clickable=1,o.alertBox.timer&&clearTimeout(o.alertBox.timer),o.alertBox.timer=setTimeout((function(){o.alertBox.opacity=0,o.alertBox.clickable=0}),1e3)},o.waiting=Waiting({animated:1,coverBackgroundColor:"rgba(0,0,0,0.6)",waitingIcon:"../../comp-m2/waiting/clock3.png"}),o.waiting.icon.elem.style.filter="invert(100%)",o.loginBtn.on("click",l),o.signupBtn.on("click",s),a(),n(),o.setActiveTab(0)}(),endObject(o)};